<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .option-btn { transition: 0.3s; }
        .option-btn.correct { background-color: #4ade80 !important; color: white; }
        .option-btn.wrong { background-color: #f87171 !important; color: white; }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-100 to-indigo-100 min-h-screen flex items-center justify-center">

<div id="quiz-box" class="bg-white p-8 rounded-2xl shadow-2xl w-[90%] max-w-xl">
    <h2 id="quiz-title" class="text-3xl font-bold mb-4"></h2>

    <div id="question-box" class="text-xl mb-6"></div>
    <div id="options-box" class="space-y-4"></div>

    <button id="nextBtn"
            class="mt-6 bg-blue-600 text-white py-3 w-full rounded-xl text-lg hidden">
        Next Question â†’
    </button>
</div>

<script>
let quizData, index = 0, score = 0;

async function loadQuiz() {
    const fileName = localStorage.getItem("quizFile");
    const response = await fetch("data/" + fileName);
    quizData = await response.json();

    document.getElementById("quiz-title").innerText = quizData.title;
    showQuestion();
}

function showQuestion() {
    const q = quizData.questions[index];

    document.getElementById("question-box").innerText = q.question;
    const optionsBox = document.getElementById("options-box");
    optionsBox.innerHTML = "";
    document.getElementById("nextBtn").classList.add("hidden");

    q.options.forEach(option => {
        const btn = document.createElement("button");
        btn.className = "option-btn w-full bg-gray-100 py-3 rounded-lg text-lg hover:bg-gray-200";
        btn.textContent = option;

        btn.onclick = () => checkAnswer(btn, option, q.answer);
        optionsBox.appendChild(btn);
    });
}

function checkAnswer(btn, selected, correct) {
    const allButtons = document.querySelectorAll(".option-btn");

    allButtons.forEach(b => b.disabled = true);

    if (selected === correct) {
        btn.classList.add("correct");
        score++;
    } else {
        btn.classList.add("wrong");

        // highlight correct answer
        allButtons.forEach(b => {
            if (b.textContent === correct) b.classList.add("correct");
        });
    }

    document.getElementById("nextBtn").classList.remove("hidden");
}

document.getElementById("nextBtn").onclick = () => {
    index++;
    if (index < quizData.questions.length) {
        showQuestion();
    } else {
        showResult();
    }
};

function showResult() {
    document.getElementById("quiz-box").innerHTML = `
        <h2 class="text-4xl font-bold text-center text-green-600">ðŸŽ‰ Quiz Completed!</h2>

        <p class="text-center text-2xl mt-4">
            Your Score: <span class="font-bold">${score}</span> /
            ${quizData.questions.length}
        </p>

        <div class="text-center mt-6">
            <a href="category.html">
                <button class="bg-blue-600 text-white py-3 px-6 rounded-xl text-lg">
                    Back to Categories
                </button>
            </a>
        </div>
    `;
}

loadQuiz();
</script>

</body>
</html>
